<!doctype html><html lang="en"><head><title>KnowBetter based on Icebreakers</title><script defer src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script><meta charset="utf-8"/><meta name="description" content="A collection of icebreaking questions from around the web"/><meta name="twitter:card" content="summary_large_image"><meta name="twitter:description" content="A collection of icebreaking questions from around the web"><meta name="twitter:image" content="https://rendall.github.io/icebreakers/images/1200x675.png"><meta name="twitter:site" content="@rendall"><meta name="twitter:title" content="Icebreakers"><meta name="viewport" content="width=device-width,initial-scale=1"/><meta property="og:description" content="A collection of icebreaking questions from around the web"><meta property="og:image" content="https://rendall.github.io/icebreakers/images/1200x1200.png"><meta property="og:title" content="Icebreakers"><meta property="og:url" content="https://rendall.github.io/icebreakers/"><link rel="icon" type="image/png" href="favicon.svg"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/><script defer="defer" src="main.js?v=2"></script><!-- Place this AFTER the existing main.js include -->
<script>
(function () {
  // --- Helpers ---
  const isMobile = () => {
    // conservative mobile check: UA + viewport width
    return /Android|iPhone|iPad|iPod|IEMobile|Opera Mini/i.test(navigator.userAgent)
           || (Math.min(window.screen.width, window.screen.height) <= 820);
  };

  // Decide target size by device
  function getTargetDimensions() {
    if (isMobile()) {
      // 9:16 (portrait) — Instagram Story friendly
      return { width: 1080, height: 1920, ratioLabel: '9:16' };
    }
    // Desktop → 19:6 (landscape) as requested
    // If you prefer 16:9, replace with: return { width: 1920, height: 1080, ratioLabel: '16:9' };
    return { width: 1900, height: 600, ratioLabel: '19:6' };
  }

  // Simple text wrap that returns lines array
  function wrapLines(ctx, text, maxWidth) {
    const words = (text || '').trim().split(/\s+/);
    let line = '';
    const lines = [];
    for (let i = 0; i < words.length; i++) {
      const test = line ? line + ' ' + words[i] : words[i];
      if (ctx.measureText(test).width > maxWidth && line) {
        lines.push(line);
        line = words[i];
      } else {
        line = test;
      }
    }
    if (line) lines.push(line);
    return lines;
  }

  // Pull footer text dynamically from .footer-col-3 li
  function getFooterLines() {
    const footer = document.querySelector('.footer-col-3');
    const lines = [];
    if (footer) {
      footer.querySelectorAll('li').forEach(li => {
        const t = (li.innerText || '').trim();
        if (t) lines.push(t);
      });
    }
    return lines;
  }

  // Main generator: centers question, stacks footer at bottom
  async function generateResponsiveImage() {
    const { width, height } = getTargetDimensions();
    const canvas = document.createElement('canvas');
    canvas.width = width;
    canvas.height = height;
    const ctx = canvas.getContext('2d');

    // Background
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0, 0, width, height);

    // Pull texts
    const questionText = (document.getElementById('question-display')?.innerText || '').trim();
    const footerLines = getFooterLines(); // e.g., ["KnowBetter based on Icebreakers", "rendall.github.io/icebreakers"]

    // Layout constants scale with canvas
    const padding = Math.round(Math.min(width, height) * 0.05); // 5%
    const maxTextWidth = Math.round(width * 0.82);

    // Footer typography
    ctx.fillStyle = '#444';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'alphabetic';
    ctx.font = `${Math.round(width * 0.028)}px system-ui, -apple-system, Segoe UI, Roboto, Arial`;
    const footerLineHeight = Math.round(width * 0.036);

    // Compute footer block height
    const footerBlockHeight = footerLines.length ? (footerLines.length * footerLineHeight) : 0;
    const footerBottomPad = Math.max(padding, Math.round(height * 0.04));
    const footerTopY = height - footerBottomPad - footerBlockHeight;

    // Draw footer (stacked)
    footerLines.forEach((line, idx) => {
      ctx.fillText(line, width / 2, footerTopY + (idx + 1) * footerLineHeight);
    });

    // Question typography (bigger)
    ctx.fillStyle = '#000';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'top';

    // Start from a big font and shrink until it fits nicely in width
    let fontPx = Math.round(width * 0.072); // initial guess (~ 78px for 1080 width)
    const minPx = Math.max(20, Math.round(width * 0.036));

    function setFont(px){ ctx.font = `bold ${px}px system-ui, -apple-system, Segoe UI, Roboto, Arial`; }

    setFont(fontPx);
    let lines = wrapLines(ctx, questionText, maxTextWidth);
    // If too many lines to fit between top & above footer, reduce font
    const gapToFooter = footerLines.length ? Math.round(height * 0.07) : Math.round(height * 0.1);
    const availableHeight = footerTopY - padding - gapToFooter;

    let lineHeight = Math.round(fontPx * 1.25);
    while ((lines.length * lineHeight) > availableHeight && fontPx > minPx) {
      fontPx -= 2;
      setFont(fontPx);
      lineHeight = Math.round(fontPx * 1.25);
      lines = wrapLines(ctx, questionText, maxTextWidth);
    }

    // Vertical centering within the middle band (top padding to footerTopY - gap)
    const totalTextHeight = lines.length * lineHeight;
    const middleTop = padding;
    const middleBottom = footerTopY - gapToFooter;
    const middleHeight = middleBottom - middleTop;
    const startY = middleTop + Math.max(0, Math.floor((middleHeight - totalTextHeight) / 2));

    // Draw question lines
    lines.forEach((l, i) => {
      ctx.fillText(l, width / 2, startY + i * lineHeight);
    });

    // Export
    const blob = await new Promise(res => canvas.toBlob(res, 'image/png', 1));
    const file = new File([blob], 'icebreaker.png', { type: 'image/png' });
    return { blob, file };
  }

  // Share (Android Chrome) or download fallback
  async function doShareOrDownload() {
    try {
      const { blob, file } = await generateResponsiveImage();
      if (navigator.canShare && navigator.canShare({ files: [file] })) {
        await navigator.share({ files: [file], title: 'Icebreaker' });
      } else {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'icebreaker.png';
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
        alert('Image saved. Upload to Instagram Stories or TikTok.');
      }
    } catch (e) {
      console.error(e);
      alert('Sharing failed. Please try again or save the image manually.');
    }
  }

  // Wire up Share + optional Download buttons
  document.addEventListener('DOMContentLoaded', () => {
    const share = document.getElementById('post-link');
    if (share) {
      const clone = share.cloneNode(true);
      share.replaceWith(clone); // avoid double listeners from bundled code
      clone.addEventListener('click', (e) => { e.preventDefault(); doShareOrDownload(); });
    }
    const dl = document.getElementById('download-link');
    if (dl) {
      const clone = dl.cloneNode(true);
      dl.replaceWith(clone);
      clone.addEventListener('click', async (e) => {
        e.preventDefault();
        const { blob } = await generateResponsiveImage();
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'icebreaker.png';
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      });
    }
  });
})();
</script>
<link href="main.css" rel="stylesheet"></head><body><main><h2 id="question-display">...</h2></main><footer><button id="reload-button" class="footer-col-2">Ganti Pertanyaan Lain</button><ul class="footer-col-1"><li><label>Got a nice answer? <ul class="actions">
<div class="actions-row">
  <a id="post-link" href="#">Share it!</a>
  <a id="download-link" href="#">Download image</a>
  <a id="copy-link" href="#">Copy image</a>
</div>
  <li><label>Iseng2nya <a id="credit-link" href=""></a></label></li>
</ul>
</label></li></li></ul><div class="footer-col-3"><ul><li><a href="https://github.com/rendall/icebreakers#readme"><em>KnowBetter </em> based on <em>Icebreakers</em></a></li><li><a href="https://rendall.github.io/icebreakers">rendall.github.io/&#8203;icebreakers</a></li></ul><button id="change-theme-button" title="Change color theme" aria-label="Change color theme"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 64 64" enable-background="new 0 0 64 64" xml:space="preserve"><g><path d="M32,61c-7.8,0-15.2-3.1-20.7-8.7c-5.5-5.6-8.5-13-8.3-20.8C3.2,16.5,15.2,4,30.2,3.1c10.8-0.7,20.7,4.5,26.4,13.5   c0.6,0.9,0.6,2,0.1,3c-0.6,1.1-1.8,1.7-3.1,1.5C53,21,52.5,21,52,21c-5.9,0-10.8,4.8-11,10.6c-0.1,3,1,5.9,3.1,8   C46.2,41.8,49,43,52,43c0.5,0,1,0,1.5-0.1c1.3-0.2,2.5,0.4,3.1,1.5c0.5,1,0.5,2.1-0.1,3C51.2,55.9,42,61,32,61z M32,5   c-0.6,0-1.1,0-1.7,0.1C16.3,5.9,5.2,17.6,5,31.6c-0.1,7.3,2.6,14.2,7.8,19.4C17.9,56.1,24.7,59,32,59c9.3,0,17.9-4.7,22.8-12.6   c0.3-0.4,0.1-0.8,0-1c-0.2-0.3-0.6-0.6-1.1-0.5C53.2,45,52.6,45,52,45c-3.6,0-6.9-1.4-9.3-4c-2.5-2.6-3.8-5.9-3.6-9.5   c0.2-6.9,6-12.5,12.9-12.6l0.1,0c0.6,0,1.2,0,1.8,0.1c0.5,0.1,0.9-0.2,1.1-0.5c0.1-0.2,0.2-0.5,0-0.9C49.9,9.7,41.3,5,32,5z"/><path d="M31,55c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S34.3,55,31,55z M31,45c-2.2,0-4,1.8-4,4s1.8,4,4,4s4-1.8,4-4S33.2,45,31,45z"/><path d="M16,46c-2.2,0-4-1.8-4-4s1.8-4,4-4s4,1.8,4,4S18.2,46,16,46z M16,40c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S17.1,40,16,40z"/><path d="M12,34c-2.2,0-4-1.8-4-4s1.8-4,4-4s4,1.8,4,4S14.2,34,12,34z M12,28c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S13.1,28,12,28z"/><path d="M18,22c-2.2,0-4-1.8-4-4s1.8-4,4-4s4,1.8,4,4S20.2,22,18,22z M18,16c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S19.1,16,18,16z"/><path d="M30,16c-2.2,0-4-1.8-4-4s1.8-4,4-4s4,1.8,4,4S32.2,16,30,16z M30,10c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S31.1,10,30,10z"/></g></svg></button></div></footer></body></html>