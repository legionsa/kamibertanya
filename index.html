<!doctype html><html lang="en"><head><title>KnowBetter based on Icebreakers</title><script defer src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script><meta charset="utf-8"/><meta name="description" content="A collection of icebreaking questions from around the web"/><meta name="twitter:card" content="summary_large_image"><meta name="twitter:description" content="A collection of icebreaking questions from around the web"><meta name="twitter:image" content="https://rendall.github.io/icebreakers/images/1200x675.png"><meta name="twitter:site" content="@rendall"><meta name="twitter:title" content="Icebreakers"><meta name="viewport" content="width=device-width,initial-scale=1"/><meta property="og:description" content="A collection of icebreaking questions from around the web"><meta property="og:image" content="https://rendall.github.io/icebreakers/images/1200x1200.png"><meta property="og:title" content="Icebreakers"><meta property="og:url" content="https://rendall.github.io/icebreakers/"><link rel="icon" type="image/png" href="favicon.svg"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/><script defer="defer" src="main.js?v=2"></script><!-- Place this AFTER the existing main.js include -->
<script>
(function () {
  // --- Main Image Generator (from previous step) ---
  async function generateShareImage() {
    const getTargetDimensions = () => /Android|iPhone|iPad|iPod|iPod Mini/i.test(navigator.userAgent) || (Math.min(window.screen.width, window.screen.height) <= 820) ? { width: 1080, height: 1920 } : { width: 1900, height: 600 };
    const { width, height } = getTargetDimensions();
    const canvas = document.createElement('canvas');
    canvas.width = width;
    canvas.height = height;
    const ctx = canvas.getContext('2d');

    // 1. Recreate the background and duotone effect
    const css = getComputedStyle(document.documentElement);
    const surface = (css.getPropertyValue('--theme-background') || '#0f0f11').trim();
    const bgVar = css.getPropertyValue('--bg-image') || '';
    const bgOpacity = parseFloat(css.getPropertyValue('--bg-opacity')) || 0.2;
    const duoA = (css.getPropertyValue('--duo-a') || '#f784c5').trim();
    const duoB = (css.getPropertyValue('--duo-b') || '#1b602f').trim();
    const accent = (css.getPropertyValue('--accent') || '#000072').trim();
    let bgUrl = null;
    const m = bgVar.match(/url\((?:'|")?(.+?)(?:'|")?\)/i);
    if (m && m[1]) bgUrl = m[1];

    ctx.fillStyle = surface;
    ctx.fillRect(0, 0, width, height);

    if (bgUrl) {
      await new Promise((resolve, reject) => {
        const img = new Image();
        img.crossOrigin = 'anonymous';
        img.onload = () => {
          const ir = img.naturalWidth / img.naturalHeight, cr = width / height;
          let dw = width, dh = height;
          if (ir > cr) { dh = height; dw = dh * ir; } else { dw = width; dh = dw / ir; }
          const dx = (width - dw) / 2, dy = (height - dh) / 2;
          ctx.save();
          ctx.globalAlpha = bgOpacity;
          ctx.drawImage(img, dx, dy, dw, dh);
          const imgData = ctx.getImageData(0, 0, width, height);
          const d = imgData.data;
          for (let i = 0; i < d.length; i += 4) {
            const gy = d[i] * 0.2126 + d[i + 1] * 0.7152 + d[i + 2] * 0.0722;
            d[i] = d[i + 1] = d[i + 2] = gy;
          }
          ctx.putImageData(imgData, 0, 0);
          ctx.restore();
          resolve();
        };
        img.onerror = reject;
        img.src = new URL(bgUrl, window.location.href).href;
      });
    }

    ctx.globalCompositeOperation = 'multiply';
    const radial = ctx.createRadialGradient(width * 0.2, height * 0.2, 0, width * 0.2, height * 0.2, Math.max(width, height) * 0.6);
    radial.addColorStop(0, `${duoA}66`); radial.addColorStop(1, '#0000');
    ctx.fillStyle = radial; ctx.fillRect(0, 0, width, height);
    const lin = ctx.createLinearGradient(0, 0, width, height);
    lin.addColorStop(0, `${duoA}73`); lin.addColorStop(1, `${duoB}73`);
    ctx.fillStyle = lin; ctx.fillRect(0, 0, width, height);
    const top = ctx.createLinearGradient(0, 0, 0, height);
    top.addColorStop(0, `${accent}1A`); top.addColorStop(1, '#0000');
    ctx.fillStyle = top; ctx.fillRect(0, 0, width, height);
    ctx.globalCompositeOperation = 'source-over';

    // 2. Draw text
    const questionText = (document.getElementById('question-display')?.innerText || '').trim();
    const footerLines = Array.from(document.querySelector('footer').querySelectorAll('p, a')).map(el => (el.innerText || '').trim()).filter(Boolean);
    const padding = Math.round(Math.min(width, height) * 0.05);
    const maxTextWidth = Math.round(width * 0.82);
    const wrapLines = (ctx, text, maxWidth) => {
        const words = (text || '').trim().split(/\s+/), lines = [];
        let line = '';
        for (let i = 0; i < words.length; i++) {
            const test = line ? `${line} ${words[i]}` : words[i];
            if (ctx.measureText(test).width > maxWidth && line) { lines.push(line); line = words[i]; } else { line = test; }
        }
        if (line) lines.push(line);
        return lines;
    };

    const textColor = css.getPropertyValue('--theme-foreground').trim() || '#fff';
    ctx.fillStyle = textColor;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'alphabetic';
    ctx.font = `${Math.round(width * 0.028)}px system-ui, -apple-system, Segoe UI, Roboto, Arial`;
    const footerLineHeight = Math.round(width * 0.036);
    const footerTopY = height - (Math.max(padding, Math.round(height * 0.04))) - (footerLines.length * footerLineHeight);
    footerLines.forEach((line, idx) => ctx.fillText(line, width / 2, footerTopY + (idx + 1) * footerLineHeight));
    
    ctx.textBaseline = 'top';
    let fontPx = Math.round(width * 0.072);
    const setFont = px => { ctx.font = `bold ${px}px system-ui, -apple-system, Segoe UI, Roboto, Arial`; };
    setFont(fontPx);
    const gapToFooter = footerLines.length ? Math.round(height * 0.07) : Math.round(height * 0.1);
    let lineHeight = Math.round(fontPx * 1.25);
    let lines = wrapLines(ctx, questionText, maxTextWidth);
    while ((lines.length * lineHeight) > (footerTopY - padding - gapToFooter) && fontPx > 20) {
        fontPx -= 2; setFont(fontPx); lineHeight = Math.round(fontPx * 1.25); lines = wrapLines(ctx, questionText, maxTextWidth);
    }
    const startY = padding + Math.max(0, Math.floor(((footerTopY - gapToFooter - padding) - (lines.length * lineHeight)) / 2));
    lines.forEach((l, i) => ctx.fillText(l, width / 2, startY + i * lineHeight));

    // 3. Export
    const blob = await new Promise(res => canvas.toBlob(res, 'image/png', 1));
    return { blob, file: new File([blob], 'icebreaker.png', { type: 'image/png' }) };
  }

  // --- Action Functions ---

  async function doShare() {
    try {
      const { file } = await generateShareImage();
      if (navigator.canShare && navigator.canShare({ files: [file] })) {
        await navigator.share({ files: [file], title: 'Icebreaker' });
      } else {
        alert("Web Share is not supported by your browser. Try downloading the image instead.");
      }
    } catch (e) { console.error(e); alert('Sharing failed.'); }
  }

  async function downloadImage() {
    try {
        const { blob } = await generateShareImage();
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'icebreaker.png';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    } catch (e) {
        console.error('Download failed:', e);
        alert('Download failed. Please try again.');
    }
  }

  async function copyImage() {
    try {
        if (!navigator.clipboard || !navigator.clipboard.write) {
            alert('Copying images is not supported by your browser. The image will be downloaded instead.');
            await downloadImage();
            return;
        }
        const { blob } = await generateShareImage();
        await navigator.clipboard.write([new ClipboardItem({ [blob.type]: blob })]);
        alert('Image copied to clipboard!');
    } catch (e) {
        console.error('Copy failed:', e);
        alert('Copy failed. Please try downloading the image.');
    }
  }

  function copyText() {
    try {
        const text = document.getElementById('question-display')?.innerText || '';
        navigator.clipboard.writeText(text);
        alert('Text copied to clipboard!');
    } catch (e) {
        console.error('Copy text failed:', e);
        alert('Could not copy text.');
    }
  }

  // --- Wire up Event Listeners ---
  document.addEventListener('DOMContentLoaded', () => {
    const shareBtn = document.getElementById('post-link');
    const downloadBtn = document.getElementById('download-link');
    const copyImgBtn = document.getElementById('copy-image-link');
    const copyTxtBtn = document.getElementById('copy-text-link');

    if(shareBtn) shareBtn.addEventListener('click', (e) => { e.preventDefault(); doShare(); });
    if(downloadBtn) downloadBtn.addEventListener('click', (e) => { e.preventDefault(); downloadImage(); });
    if(copyImgBtn) copyImgBtn.addEventListener('click', (e) => { e.preventDefault(); copyImage(); });
    if(copyTxtBtn) copyTxtBtn.addEventListener('click', (e) => { e.preventDefault(); copyText(); });
  });
})();

(function() {
  // --- This is the second script you provided, which sets the random background. It works with the above script. ---
  const IMAGES = [ 'src/images/bg1.jpg', 'src/images/bg2.webp', 'src/images/bg3.webp', 'src/images/bg4.jpg', 'src/images/bg5.webp', 'src/images/bg6.webp', 'src/images/bg7.jpeg' ];
  function pick(arr) { return arr[Math.floor(Math.random() * arr.length)]; }
  function clamp(n, min, max) { return Math.max(min, Math.min(max, n)); }
  function jitter(hex, j = 8) {
    const h = hex.replace('#', '');
    const n = parseInt(h.length === 3 ? h.split('').map(c => c + c).join('') : h, 16);
    const rand = (v) => clamp(v + Math.round((Math.random() * 2 - 1) * j), 0, 255);
    const r = rand((n >> 16) & 255), g = rand((n >> 8) & 255), b = rand(n & 255);
    return `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).padStart(6, '0')}`;
  }
  function applyRandomBackground() {
    if (!IMAGES.length) return;
    document.documentElement.style.setProperty('--bg-image', `url("${pick(IMAGES)}")`);
    document.documentElement.style.setProperty('--duo-a', jitter('#f784c5', 10));
    document.documentElement.style.setProperty('--duo-b', jitter('#1b602f', 10));
    document.documentElement.style.setProperty('--accent', jitter('#000072', 6));
  }
  document.addEventListener('DOMContentLoaded', applyRandomBackground);
  document.addEventListener('DOMContentLoaded', () => {
    const btn = document.getElementById('change-theme-button');
    if (btn) btn.addEventListener('click', applyRandomBackground);
  });
})();
</script>
<link href="main.css" rel="stylesheet"></head><body><main><h2 id="question-display">...</h2></main><footer><button id="reload-button" class="footer-col-2">Rakyat Bertanya</button><button id="post-link" class="footer-col-2" title="Bagikan" aria-label="Bagikan">
  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
       viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
    <path d="M 18 2 A 3 3 0 0 0 15 5 A 3 3 0 0 0 15.054688 5.5605469 L 7.9394531 9.7109375 A 3 3 0 0 0 6 9 A 3 3 0 0 0 3 12 A 3 3 0 0 0 6 15 A 3 3 0 0 0 7.9355469 14.287109 L 15.054688 18.439453 A 3 3 0 0 0 15 19 A 3 3 0 0 0 18 22 A 3 3 0 0 0 21 19 A 3 3 0 0 0 18 16 A 3 3 0 0 0 16.0625 16.712891 L 8.9453125 12.560547 A 3 3 0 0 0 9 12 A 3 3 0 0 0 8.9453125 11.439453 L 16.060547 7.2890625 A 3 3 0 0 0 18 8 A 3 3 0 0 0 21 5 A 3 3 0 0 0 18 2 z"/>
  </svg>
</button>
<ul class="footer-col-1"><li><label>Got a nice answer? <ul class="actions">
<div class="actions-row">
  <a id="download-link" href="#">Download image</a>
  <a id="copy-link" href="#">Copy image</a>
</div>
  <li><label>Iseng2nya <a id="credit-link" href=""></a></label></li>
</ul>
</label></li></li></ul><div class="footer-col-3"><ul><li><a href="https://github.com/rendall/icebreakers#readme"><em>RakyatBertanya </em> based on <em>Icebreakers</em></a></li><li><a href="https://rendall.github.io/icebreakers">kamibertanya.netlify.app/</a></li></ul><button id="change-theme-button" title="Change color theme" aria-label="Change color theme"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 64 64" enable-background="new 0 0 64 64" xml:space="preserve"><g><path d="M32,61c-7.8,0-15.2-3.1-20.7-8.7c-5.5-5.6-8.5-13-8.3-20.8C3.2,16.5,15.2,4,30.2,3.1c10.8-0.7,20.7,4.5,26.4,13.5   c0.6,0.9,0.6,2,0.1,3c-0.6,1.1-1.8,1.7-3.1,1.5C53,21,52.5,21,52,21c-5.9,0-10.8,4.8-11,10.6c-0.1,3,1,5.9,3.1,8   C46.2,41.8,49,43,52,43c0.5,0,1,0,1.5-0.1c1.3-0.2,2.5,0.4,3.1,1.5c0.5,1,0.5,2.1-0.1,3C51.2,55.9,42,61,32,61z M32,5   c-0.6,0-1.1,0-1.7,0.1C16.3,5.9,5.2,17.6,5,31.6c-0.1,7.3,2.6,14.2,7.8,19.4C17.9,56.1,24.7,59,32,59c9.3,0,17.9-4.7,22.8-12.6   c0.3-0.4,0.1-0.8,0-1c-0.2-0.3-0.6-0.6-1.1-0.5C53.2,45,52.6,45,52,45c-3.6,0-6.9-1.4-9.3-4c-2.5-2.6-3.8-5.9-3.6-9.5   c0.2-6.9,6-12.5,12.9-12.6l0.1,0c0.6,0,1.2,0,1.8,0.1c0.5,0.1,0.9-0.2,1.1-0.5c0.1-0.2,0.2-0.5,0-0.9C49.9,9.7,41.3,5,32,5z"/><path d="M31,55c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S34.3,55,31,55z M31,45c-2.2,0-4,1.8-4,4s1.8,4,4,4s4-1.8,4-4S33.2,45,31,45z"/><path d="M16,46c-2.2,0-4-1.8-4-4s1.8-4,4-4s4,1.8,4,4S18.2,46,16,46z M16,40c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S17.1,40,16,40z"/><path d="M12,34c-2.2,0-4-1.8-4-4s1.8-4,4-4s4,1.8,4,4S14.2,34,12,34z M12,28c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S13.1,28,12,28z"/><path d="M18,22c-2.2,0-4-1.8-4-4s1.8-4,4-4s4,1.8,4,4S20.2,22,18,22z M18,16c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S19.1,16,18,16z"/><path d="M30,16c-2.2,0-4-1.8-4-4s1.8-4,4-4s4,1.8,4,4S32.2,16,30,16z M30,10c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S31.1,10,30,10z"/></g></svg></button></div></footer></body></html>